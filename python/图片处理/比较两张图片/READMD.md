# 比较两张图片

## 1、结论
网上很多比较方法，多数在于图片上的动作是否相似。

我的需求是比较两张图片的包含颜色的相似度，好多方法没法比较颜色相似度。

## 2、解决
根据每个像素点的值来推断是纯白照片还是纯黑照片，还能设置大致的阈值。

## 3、打包优化
```
pyinstaller --exclude-module numpy --exclude-module tkinter --exclude-module PyQt5 --exclude-module PyQt5.QtGui --exclude-module PyQt5.QtCore --exclude-module PyQt5.QtWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtPrintSupport --exclude-module PyQt5.QtSvg --exclude-module PyQt5.QtNetwork --exclude-module PyQt5.QtSql --exclude-module PyQt5.QtXml --exclude-module PyQt5.QtOpenGL --exclude-module PyQt5.QtMultimedia --exclude-module PyQt5.QtMultimediaWidgets --exclude-module PyQt5.QtPositioning --exclude-module PyQt5.QtQuick --exclude-module PyQt5.QtQml --exclude-module PyQt5.QtTest --exclude-module PyQt5.QtBluetooth --exclude-module PyQt5.QtNfc --exclude-module PyQt5.QtSerialPort --exclude-module PyQt5.QtWebSockets --exclude-module PyQt5.QtWebChannel --exclude-module PyQt5.QtWebEngine --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtX11Extras --exclude-module PyQt5.QtWinExtras --exclude-module PyQt5.QtMacExtras --exclude-module PyQt5.QtAndroidExtras --exclude-module PyQt5.QtWebEngineWidgets --exclude-module PyQt5.QtWebEngineCore --exclude-module PyQt5.QtWebChannel -F identify_black_white_image_optimize.py
```
并没有什么卵用。

## 4、替代cv2库转换灰度图像
网上搜索到PIL，然后在转换成数组时需要用到numpy，然后打包出来340MB。。。。。。

之前分析主要是numpy库引起的文件大，cv2库内部实际也是使用了numpy。

## 5、尝试使用PIL来判断像素点颜色
95.2MB优化到极限了。
